"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/webhooks";
exports.ids = ["pages/api/webhooks"];
exports.modules = {

/***/ "faunadb":
/*!**************************!*\
  !*** external "faunadb" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("faunadb");

/***/ }),

/***/ "stripe":
/*!*************************!*\
  !*** external "stripe" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stripe");

/***/ }),

/***/ "./src/pages/api/_lib/manageSubscription.ts":
/*!**************************************************!*\
  !*** ./src/pages/api/_lib/manageSubscription.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"saveSubscription\": () => (/* binding */ saveSubscription)\n/* harmony export */ });\n/* harmony import */ var faunadb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! faunadb */ \"faunadb\");\n/* harmony import */ var faunadb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(faunadb__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _services_fauna__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../services/fauna */ \"./src/services/fauna.ts\");\n/* harmony import */ var _services_stripe__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../services/stripe */ \"./src/services/stripe.ts\");\n\n\n\nasync function saveSubscription(subscriptionId, customerId, createAction = false) {\n    // Buscar o usuario no bando do FaunaDB com o ID {customerId}\n    const userRef = await _services_fauna__WEBPACK_IMPORTED_MODULE_1__.fauna.query(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Select(\"ref\", faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Get(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Match(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Index(\"user_by_stripe_customer_id\"), customerId))));\n    const subscription = await _services_stripe__WEBPACK_IMPORTED_MODULE_2__.stripe.subscriptions.retrieve(subscriptionId);\n    const subscriptionData = {\n        id: subscription.id,\n        userId: userRef,\n        status: subscription.status,\n        price_id: subscription.items.data[0].price.id\n    };\n    if (createAction) {\n        // Salvar os dados da subscription no FaunaDB\n        await _services_fauna__WEBPACK_IMPORTED_MODULE_1__.fauna.query(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Create(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Collection(\"subscriptions\"), {\n            data: subscriptionData\n        }));\n    } else {\n        await _services_fauna__WEBPACK_IMPORTED_MODULE_1__.fauna.query(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Replace(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Select(\"ref\", faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Get(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Match(faunadb__WEBPACK_IMPORTED_MODULE_0__.query.Index(\"subscription_by_id\"), subscriptionId))), {\n            data: subscriptionData\n        }));\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcGFnZXMvYXBpL19saWIvbWFuYWdlU3Vic2NyaXB0aW9uLnRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQStCO0FBQ2dCO0FBQ0U7QUFFMUMsZUFBZUcsZ0JBQWdCLENBQ3BDQyxjQUFzQixFQUN0QkMsVUFBa0IsRUFDbEJDLFlBQVksR0FBRyxLQUFLLEVBQ3BCLENBQUM7SUFDRCxFQUE2RDtJQUM3RCxLQUFLLENBQUNDLE9BQU8sR0FBRyxLQUFLLENBQUNOLHdEQUFXLENBQy9CRCxpREFBWSxDQUNWLENBQUssTUFDTEEsOENBQVMsQ0FDUEEsZ0RBQVcsQ0FBQ0EsZ0RBQVcsQ0FBQyxDQUE0Qiw4QkFBR0ssVUFBVTtJQUt2RSxLQUFLLENBQUNPLFlBQVksR0FBRyxLQUFLLENBQUNWLDJFQUE2QixDQUFDRSxjQUFjO0lBRXZFLEtBQUssQ0FBQ1csZ0JBQWdCLEdBQUcsQ0FBQztRQUN4QkMsRUFBRSxFQUFFSixZQUFZLENBQUNJLEVBQUU7UUFDbkJDLE1BQU0sRUFBRVYsT0FBTztRQUNmVyxNQUFNLEVBQUVOLFlBQVksQ0FBQ00sTUFBTTtRQUMzQkMsUUFBUSxFQUFFUCxZQUFZLENBQUNRLEtBQUssQ0FBQ0MsSUFBSSxDQUFDLENBQUMsRUFBRUMsS0FBSyxDQUFDTixFQUFFO0lBQy9DLENBQUM7SUFFRCxFQUFFLEVBQUVWLFlBQVksRUFBRSxDQUFDO1FBQ2pCLEVBQTZDO1FBQzdDLEtBQUssQ0FBQ0wsd0RBQVcsQ0FDZkQsaURBQVksQ0FBQ0EscURBQWdCLENBQUMsQ0FBZSxpQkFBRyxDQUFDO1lBQy9DcUIsSUFBSSxFQUFFTixnQkFBZ0I7UUFDeEIsQ0FBQztJQUVMLENBQUMsTUFBTSxDQUFDO1FBQ04sS0FBSyxDQUFDZCx3REFBVyxDQUNmRCxrREFBYSxDQUNYQSxpREFBWSxDQUNWLENBQUssTUFDTEEsOENBQVMsQ0FDUEEsZ0RBQVcsQ0FBQ0EsZ0RBQVcsQ0FBQyxDQUFvQixzQkFBR0ksY0FBYyxLQUdqRSxDQUFDO1lBQUNpQixJQUFJLEVBQUVOLGdCQUFnQjtRQUFDLENBQUM7SUFHaEMsQ0FBQztBQUNILENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pZ25ld3MvLi9zcmMvcGFnZXMvYXBpL19saWIvbWFuYWdlU3Vic2NyaXB0aW9uLnRzPzkxYWUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcXVlcnkgfSBmcm9tIFwiZmF1bmFkYlwiO1xuaW1wb3J0IHsgZmF1bmEgfSBmcm9tIFwiLi4vLi4vLi4vc2VydmljZXMvZmF1bmFcIjtcbmltcG9ydCB7IHN0cmlwZSB9IGZyb20gXCIuLi8uLi8uLi9zZXJ2aWNlcy9zdHJpcGVcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVTdWJzY3JpcHRpb24oXG4gIHN1YnNjcmlwdGlvbklkOiBzdHJpbmcsXG4gIGN1c3RvbWVySWQ6IHN0cmluZyxcbiAgY3JlYXRlQWN0aW9uID0gZmFsc2Vcbikge1xuICAvLyBCdXNjYXIgbyB1c3VhcmlvIG5vIGJhbmRvIGRvIEZhdW5hREIgY29tIG8gSUQge2N1c3RvbWVySWR9XG4gIGNvbnN0IHVzZXJSZWYgPSBhd2FpdCBmYXVuYS5xdWVyeShcbiAgICBxdWVyeS5TZWxlY3QoXG4gICAgICBcInJlZlwiLFxuICAgICAgcXVlcnkuR2V0KFxuICAgICAgICBxdWVyeS5NYXRjaChxdWVyeS5JbmRleChcInVzZXJfYnlfc3RyaXBlX2N1c3RvbWVyX2lkXCIpLCBjdXN0b21lcklkKVxuICAgICAgKVxuICAgIClcbiAgKTtcblxuICBjb25zdCBzdWJzY3JpcHRpb24gPSBhd2FpdCBzdHJpcGUuc3Vic2NyaXB0aW9ucy5yZXRyaWV2ZShzdWJzY3JpcHRpb25JZCk7XG5cbiAgY29uc3Qgc3Vic2NyaXB0aW9uRGF0YSA9IHtcbiAgICBpZDogc3Vic2NyaXB0aW9uLmlkLFxuICAgIHVzZXJJZDogdXNlclJlZixcbiAgICBzdGF0dXM6IHN1YnNjcmlwdGlvbi5zdGF0dXMsXG4gICAgcHJpY2VfaWQ6IHN1YnNjcmlwdGlvbi5pdGVtcy5kYXRhWzBdLnByaWNlLmlkLFxuICB9O1xuXG4gIGlmIChjcmVhdGVBY3Rpb24pIHtcbiAgICAvLyBTYWx2YXIgb3MgZGFkb3MgZGEgc3Vic2NyaXB0aW9uIG5vIEZhdW5hREJcbiAgICBhd2FpdCBmYXVuYS5xdWVyeShcbiAgICAgIHF1ZXJ5LkNyZWF0ZShxdWVyeS5Db2xsZWN0aW9uKFwic3Vic2NyaXB0aW9uc1wiKSwge1xuICAgICAgICBkYXRhOiBzdWJzY3JpcHRpb25EYXRhLFxuICAgICAgfSlcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIGF3YWl0IGZhdW5hLnF1ZXJ5KFxuICAgICAgcXVlcnkuUmVwbGFjZShcbiAgICAgICAgcXVlcnkuU2VsZWN0KFxuICAgICAgICAgIFwicmVmXCIsXG4gICAgICAgICAgcXVlcnkuR2V0KFxuICAgICAgICAgICAgcXVlcnkuTWF0Y2gocXVlcnkuSW5kZXgoXCJzdWJzY3JpcHRpb25fYnlfaWRcIiksIHN1YnNjcmlwdGlvbklkKVxuICAgICAgICAgIClcbiAgICAgICAgKSxcbiAgICAgICAgeyBkYXRhOiBzdWJzY3JpcHRpb25EYXRhIH1cbiAgICAgIClcbiAgICApO1xuICB9XG59XG4iXSwibmFtZXMiOlsicXVlcnkiLCJmYXVuYSIsInN0cmlwZSIsInNhdmVTdWJzY3JpcHRpb24iLCJzdWJzY3JpcHRpb25JZCIsImN1c3RvbWVySWQiLCJjcmVhdGVBY3Rpb24iLCJ1c2VyUmVmIiwiU2VsZWN0IiwiR2V0IiwiTWF0Y2giLCJJbmRleCIsInN1YnNjcmlwdGlvbiIsInN1YnNjcmlwdGlvbnMiLCJyZXRyaWV2ZSIsInN1YnNjcmlwdGlvbkRhdGEiLCJpZCIsInVzZXJJZCIsInN0YXR1cyIsInByaWNlX2lkIiwiaXRlbXMiLCJkYXRhIiwicHJpY2UiLCJDcmVhdGUiLCJDb2xsZWN0aW9uIiwiUmVwbGFjZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/pages/api/_lib/manageSubscription.ts\n");

/***/ }),

/***/ "./src/pages/api/webhooks.ts":
/*!***********************************!*\
  !*** ./src/pages/api/webhooks.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"config\": () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _services_stripe__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../services/stripe */ \"./src/services/stripe.ts\");\n/* harmony import */ var _lib_manageSubscription__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./_lib/manageSubscription */ \"./src/pages/api/_lib/manageSubscription.ts\");\n\n\nasync function buffer(readable) {\n    const chunks = [];\n    for await (const chunk of readable){\n        chunks.push(typeof chunk === \"string\" ? Buffer.from(chunk) : chunk);\n    }\n    return Buffer.concat(chunks);\n}\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\nconst relevantEvents = new Set([\n    \"checkout.session.completed\",\n    \"customer.subscription.updated\",\n    \"customer.subscription.deleted\", \n]);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (async (request, response)=>{\n    if (request.method === \"POST\") {\n        const buf = await buffer(request);\n        const secret = request.headers[\"stripe-signature\"];\n        let event;\n        try {\n            event = _services_stripe__WEBPACK_IMPORTED_MODULE_0__.stripe.webhooks.constructEvent(buf, secret, process.env.STRIPE_WEBHOOK_SECRET);\n        } catch (err) {\n            return response.status(400).send(`Webhook error: ${err.message}`);\n        }\n        const { type  } = event;\n        if (relevantEvents.has(type)) {\n            try {\n                switch(type){\n                    case \"customer.subscription.updated\":\n                    case \"customer.subscription.deleted\":\n                        const subscription = event.data.object;\n                        await (0,_lib_manageSubscription__WEBPACK_IMPORTED_MODULE_1__.saveSubscription)(subscription.id, subscription.customer.toString(), false);\n                        break;\n                    case \"checkout.session.completed\":\n                        const checkoutSession = event.data.object;\n                        await (0,_lib_manageSubscription__WEBPACK_IMPORTED_MODULE_1__.saveSubscription)(checkoutSession.subscription.toString(), checkoutSession.customer.toString(), true);\n                        break;\n                    default:\n                        throw new Error(\"Unhandled event.\");\n                }\n            } catch (err) {\n                return response.json({\n                    error: \"Webhook handle failed.\"\n                });\n            }\n        }\n        response.json({\n            received: true\n        });\n    } else {\n        response.setHeader(\"Allow\", \"POST\");\n        response.status(405).end(\"Method not allowed\");\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDLENBQUM7WUFBQ0UsUUFBUSxFQUFFLElBQUk7UUFBQyxDQUFDO0lBQ2xDLENBQUMsTUFBTSxDQUFDO1FBQ04zQixRQUFRLENBQUM0QixTQUFTLENBQUMsQ0FBTyxRQUFFLENBQU07UUFDbEM1QixRQUFRLENBQUNZLE1BQU0sQ0FBQyxHQUFHLEVBQUVpQixHQUFHLENBQUMsQ0FBb0I7SUFDL0MsQ0FBQztBQUNILENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pZ25ld3MvLi9zcmMvcGFnZXMvYXBpL3dlYmhvb2tzLnRzP2QzYTQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gXCJuZXh0XCI7XG5pbXBvcnQgeyBSZWFkYWJsZSB9IGZyb20gXCJzdHJlYW1cIjtcbmltcG9ydCBTdHJpcGUgZnJvbSBcInN0cmlwZVwiO1xuaW1wb3J0IHsgc3RyaXBlIH0gZnJvbSBcIi4uLy4uL3NlcnZpY2VzL3N0cmlwZVwiO1xuaW1wb3J0IHsgc2F2ZVN1YnNjcmlwdGlvbiB9IGZyb20gXCIuL19saWIvbWFuYWdlU3Vic2NyaXB0aW9uXCI7XG5cbmFzeW5jIGZ1bmN0aW9uIGJ1ZmZlcihyZWFkYWJsZTogUmVhZGFibGUpIHtcbiAgY29uc3QgY2h1bmtzID0gW107XG5cbiAgZm9yIGF3YWl0IChjb25zdCBjaHVuayBvZiByZWFkYWJsZSkge1xuICAgIGNodW5rcy5wdXNoKHR5cGVvZiBjaHVuayA9PT0gXCJzdHJpbmdcIiA/IEJ1ZmZlci5mcm9tKGNodW5rKSA6IGNodW5rKTtcbiAgfVxuXG4gIHJldHVybiBCdWZmZXIuY29uY2F0KGNodW5rcyk7XG59XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIGFwaToge1xuICAgIGJvZHlQYXJzZXI6IGZhbHNlLFxuICB9LFxufTtcblxuY29uc3QgcmVsZXZhbnRFdmVudHMgPSBuZXcgU2V0KFtcbiAgXCJjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZFwiLFxuICBcImN1c3RvbWVyLnN1YnNjcmlwdGlvbi51cGRhdGVkXCIsXG4gIFwiY3VzdG9tZXIuc3Vic2NyaXB0aW9uLmRlbGV0ZWRcIixcbl0pO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyAocmVxdWVzdDogTmV4dEFwaVJlcXVlc3QsIHJlc3BvbnNlOiBOZXh0QXBpUmVzcG9uc2UpID0+IHtcbiAgaWYgKHJlcXVlc3QubWV0aG9kID09PSBcIlBPU1RcIikge1xuICAgIGNvbnN0IGJ1ZiA9IGF3YWl0IGJ1ZmZlcihyZXF1ZXN0KTtcbiAgICBjb25zdCBzZWNyZXQgPSByZXF1ZXN0LmhlYWRlcnNbXCJzdHJpcGUtc2lnbmF0dXJlXCJdO1xuXG4gICAgbGV0IGV2ZW50OiBTdHJpcGUuRXZlbnQ7XG5cbiAgICB0cnkge1xuICAgICAgZXZlbnQgPSBzdHJpcGUud2ViaG9va3MuY29uc3RydWN0RXZlbnQoXG4gICAgICAgIGJ1ZixcbiAgICAgICAgc2VjcmV0LFxuICAgICAgICBwcm9jZXNzLmVudi5TVFJJUEVfV0VCSE9PS19TRUNSRVRcbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzKDQwMCkuc2VuZChgV2ViaG9vayBlcnJvcjogJHtlcnIubWVzc2FnZX1gKTtcbiAgICB9XG5cbiAgICBjb25zdCB7IHR5cGUgfSA9IGV2ZW50O1xuXG4gICAgaWYgKHJlbGV2YW50RXZlbnRzLmhhcyh0eXBlKSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgY2FzZSBcImN1c3RvbWVyLnN1YnNjcmlwdGlvbi51cGRhdGVkXCI6XG4gICAgICAgICAgY2FzZSBcImN1c3RvbWVyLnN1YnNjcmlwdGlvbi5kZWxldGVkXCI6XG4gICAgICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSBldmVudC5kYXRhLm9iamVjdCBhcyBTdHJpcGUuU3Vic2NyaXB0aW9uO1xuXG4gICAgICAgICAgICBhd2FpdCBzYXZlU3Vic2NyaXB0aW9uKFxuICAgICAgICAgICAgICBzdWJzY3JpcHRpb24uaWQsXG4gICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5jdXN0b21lci50b1N0cmluZygpLFxuICAgICAgICAgICAgICBmYWxzZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgXCJjaGVja291dC5zZXNzaW9uLmNvbXBsZXRlZFwiOlxuICAgICAgICAgICAgY29uc3QgY2hlY2tvdXRTZXNzaW9uID0gZXZlbnQuZGF0YVxuICAgICAgICAgICAgICAub2JqZWN0IGFzIFN0cmlwZS5DaGVja291dC5TZXNzaW9uO1xuXG4gICAgICAgICAgICBhd2FpdCBzYXZlU3Vic2NyaXB0aW9uKFxuICAgICAgICAgICAgICBjaGVja291dFNlc3Npb24uc3Vic2NyaXB0aW9uLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgIGNoZWNrb3V0U2Vzc2lvbi5jdXN0b21lci50b1N0cmluZygpLFxuICAgICAgICAgICAgICB0cnVlXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuaGFuZGxlZCBldmVudC5cIik7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbih7IGVycm9yOiBcIldlYmhvb2sgaGFuZGxlIGZhaWxlZC5cIiB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXNwb25zZS5qc29uKHsgcmVjZWl2ZWQ6IHRydWUgfSk7XG4gIH0gZWxzZSB7XG4gICAgcmVzcG9uc2Uuc2V0SGVhZGVyKFwiQWxsb3dcIiwgXCJQT1NUXCIpO1xuICAgIHJlc3BvbnNlLnN0YXR1cyg0MDUpLmVuZChcIk1ldGhvZCBub3QgYWxsb3dlZFwiKTtcbiAgfVxufTtcbiJdLCJuYW1lcyI6WyJzdHJpcGUiLCJzYXZlU3Vic2NyaXB0aW9uIiwiYnVmZmVyIiwicmVhZGFibGUiLCJjaHVua3MiLCJjaHVuayIsInB1c2giLCJCdWZmZXIiLCJmcm9tIiwiY29uY2F0IiwiY29uZmlnIiwiYXBpIiwiYm9keVBhcnNlciIsInJlbGV2YW50RXZlbnRzIiwiU2V0IiwicmVxdWVzdCIsInJlc3BvbnNlIiwibWV0aG9kIiwiYnVmIiwic2VjcmV0IiwiaGVhZGVycyIsImV2ZW50Iiwid2ViaG9va3MiLCJjb25zdHJ1Y3RFdmVudCIsInByb2Nlc3MiLCJlbnYiLCJTVFJJUEVfV0VCSE9PS19TRUNSRVQiLCJlcnIiLCJzdGF0dXMiLCJzZW5kIiwibWVzc2FnZSIsInR5cGUiLCJoYXMiLCJzdWJzY3JpcHRpb24iLCJkYXRhIiwib2JqZWN0IiwiaWQiLCJjdXN0b21lciIsInRvU3RyaW5nIiwiY2hlY2tvdXRTZXNzaW9uIiwiRXJyb3IiLCJqc29uIiwiZXJyb3IiLCJyZWNlaXZlZCIsInNldEhlYWRlciIsImVuZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/pages/api/webhooks.ts\n");

/***/ }),

/***/ "./src/services/fauna.ts":
/*!*******************************!*\
  !*** ./src/services/fauna.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"fauna\": () => (/* binding */ fauna)\n/* harmony export */ });\n/* harmony import */ var faunadb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! faunadb */ \"faunadb\");\n/* harmony import */ var faunadb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(faunadb__WEBPACK_IMPORTED_MODULE_0__);\n\nconst fauna = new faunadb__WEBPACK_IMPORTED_MODULE_0__.Client({\n    secret: process.env.FAUNADB_KEY,\n    domain: \"db.fauna.com\"\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc2VydmljZXMvZmF1bmEudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQWdDO0FBRXpCLEtBQUssQ0FBQ0MsS0FBSyxHQUFHLEdBQUcsQ0FBQ0QsMkNBQU0sQ0FBQyxDQUFDO0lBQy9CRSxNQUFNLEVBQUVDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxXQUFXO0lBQy9CQyxNQUFNLEVBQUUsQ0FBYztBQUN4QixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaWduZXdzLy4vc3JjL3NlcnZpY2VzL2ZhdW5hLnRzPzMyM2EiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2xpZW50IH0gZnJvbSBcImZhdW5hZGJcIjtcblxuZXhwb3J0IGNvbnN0IGZhdW5hID0gbmV3IENsaWVudCh7XG4gIHNlY3JldDogcHJvY2Vzcy5lbnYuRkFVTkFEQl9LRVksXG4gIGRvbWFpbjogXCJkYi5mYXVuYS5jb21cIlxufSk7XG4iXSwibmFtZXMiOlsiQ2xpZW50IiwiZmF1bmEiLCJzZWNyZXQiLCJwcm9jZXNzIiwiZW52IiwiRkFVTkFEQl9LRVkiLCJkb21haW4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/services/fauna.ts\n");

/***/ }),

/***/ "./src/services/stripe.ts":
/*!********************************!*\
  !*** ./src/services/stripe.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"stripe\": () => (/* binding */ stripe)\n/* harmony export */ });\n/* harmony import */ var stripe__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! stripe */ \"stripe\");\n/* harmony import */ var stripe__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(stripe__WEBPACK_IMPORTED_MODULE_0__);\n\nconst stripe = new (stripe__WEBPACK_IMPORTED_MODULE_0___default())(process.env.STRIPE_API_KEY, {\n    apiVersion: '2020-08-27',\n    appInfo: {\n        name: 'Ignews',\n        version: '0.1.0'\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc2VydmljZXMvc3RyaXBlLnRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUEyQjtBQUVwQixLQUFLLENBQUNDLE1BQU0sR0FBRyxHQUFHLENBQUNELCtDQUFNLENBQzlCRSxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsY0FBYyxFQUMxQixDQUFDO0lBQ0NDLFVBQVUsRUFBRSxDQUFZO0lBQ3hCQyxPQUFPLEVBQUUsQ0FBQztRQUNSQyxJQUFJLEVBQUUsQ0FBUTtRQUNkQyxPQUFPLEVBQUUsQ0FBTztJQUNsQixDQUFDO0FBQ0gsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2lnbmV3cy8uL3NyYy9zZXJ2aWNlcy9zdHJpcGUudHM/YWI5OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgU3RyaXBlIGZyb20gJ3N0cmlwZSc7XG5cbmV4cG9ydCBjb25zdCBzdHJpcGUgPSBuZXcgU3RyaXBlKFxuICBwcm9jZXNzLmVudi5TVFJJUEVfQVBJX0tFWSxcbiAge1xuICAgIGFwaVZlcnNpb246ICcyMDIwLTA4LTI3JyxcbiAgICBhcHBJbmZvOiB7XG4gICAgICBuYW1lOiAnSWduZXdzJyxcbiAgICAgIHZlcnNpb246ICcwLjEuMCdcbiAgICB9XG4gIH1cbikiXSwibmFtZXMiOlsiU3RyaXBlIiwic3RyaXBlIiwicHJvY2VzcyIsImVudiIsIlNUUklQRV9BUElfS0VZIiwiYXBpVmVyc2lvbiIsImFwcEluZm8iLCJuYW1lIiwidmVyc2lvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/services/stripe.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("./src/pages/api/webhooks.ts"));
module.exports = __webpack_exports__;

})();